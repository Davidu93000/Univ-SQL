DROP TABLE ELEVES CASCADE CONSTRAINTS;
DROP TABLE COURS CASCADE CONSTRAINTS;
DROP TABLE PROFESSEURS CASCADE CONSTRAINTS;
DROP TABLE ACTIVITES CASCADE CONSTRAINTS;
DROP TABLE RESULTATS CASCADE CONSTRAINTS;
DROP TABLE CHARGE CASCADE CONSTRAINTS;
DROP TABLE ACTIVITES_PRATIQUEES CASCADE CONSTRAINTS;

ALTER SESSION SET NLS_DATE_FORMAT = 'DD-MM-YYYY'; 

CREATE TABLE ELEVES(
	NUM_ELEVE		NUMBER(4)		,
	NOM			VARCHAR2(25)	CONSTRAINT NN_ELEVES_NOM NOT NULL,
	PRENOM		VARCHAR2(25)	CONSTRAINT NN_ELEVES_PRENOM NOT NULL,
	DATE_NAISSANCE	DATE			,
	POIDS			NUMBER		,
	ANNEE			NUMBER		,
	CONSTRAINT PK_ELEVES_NUM PRIMARY KEY (NUM_ELEVE),
	CONSTRAINT CK_ELEVES_POIDS CHECK(POIDS >= 0),
	CONSTRAINT CK_ELEVES_ANNEE CHECK(ANNEE >= 0)
);

CREATE TABLE COURS(
	NUM_COURS		NUMBER(4)		,
	NOM			VARCHAR2(25)	CONSTRAINT NN_COURS_NOM NOT NULL,
	NBHEURES		NUMBER		,
	ANNEE			NUMBER		,
	CONSTRAINT PK_COURS PRIMARY KEY (NUM_COURS),
	CONSTRAINT CK_COURS_NBHEURES CHECK(NBHEURES > 0),
	CONSTRAINT CK_COURS_ANNEE CHECK(ANNEE >= 0)
);

CREATE TABLE PROFESSEURS(
	NUM_PROF		NUMBER(4)		,
	NOM			VARCHAR2(25)	CONSTRAINT NN_PROFESSEURS_NOM NOT NULL,
	SPECIALITE		VARCHAR2(25)	CONSTRAINT NN_PROFESSEURS_SPECIALITE NOT NULL,
	DATE_ENTREE		DATE			,
	DER_PROM		DATE			,
	SALAIRE_BASE	NUMBER		,
	SALAIRE_ACTUEL	NUMBER		,
	CONSTRAINT PK_PROFESSEURS_NUM PRIMARY KEY (NUM_PROF),
	CONSTRAINT CK_PROFESSEURS_SALAIRE_BASE CHECK(SALAIRE_BASE >= 0),
	CONSTRAINT CK_PROFESSEURS_SALAIRE_ACTUEL CHECK(SALAIRE_ACTUEL >= 0)
);

CREATE TABLE ACTIVITES(
	NIVEAU	NUMBER		,
	NOM		VARCHAR2(25)	,
	EQUIPE	VARCHAR2(25)	,
	CONSTRAINT PK_ACTIVITES PRIMARY KEY (NIVEAU,NOM)
);

CREATE TABLE RESULTATS(
	NUM_ELEVE		NUMBER(4)		,
	NUM_COURS		NUMBER(4)		,
	POINTS 		NUMBER		,
	CONSTRAINT FK_ELEVES_NUM_RESULTATS FOREIGN KEY (NUM_ELEVE) REFERENCES ELEVES,
	CONSTRAINT FK_COURS_NUM_RESULTATS FOREIGN KEY (NUM_COURS) REFERENCES COURS 
);

CREATE TABLE CHARGE(
	NUM_PROF		NUMBER(4)		,
	NUM_COURS		NUMBER(4)		,
	CONSTRAINT FK_COURS_NUM_CHARGE FOREIGN KEY (NUM_COURS) REFERENCES COURS,
	CONSTRAINT FK_PROFESSEURS_NUM_CHARGE FOREIGN KEY (NUM_PROF) REFERENCES PROFESSEURS
);

CREATE TABLE ACTIVITES_PRATIQUEES(
	NUM_ELEVE		NUMBER(4)		,
	NIVEAU		NUMBER		,
	NOM			VARCHAR2(25)	CONSTRAINT NN_NOM_ACTIVITES_PRATIQUEES NOT NULL,
	CONSTRAINT FK_ELEVES_NUM_AP FOREIGN KEY (NUM_ELEVE) REFERENCES ELEVES,
	CONSTRAINT FK_ACTIVITES_AP FOREIGN KEY (NIVEAU,NOM) REFERENCES ACTIVITES(NIVEAU,NOM)
);

/* INSERTION ELEVES */
INSERT INTO ELEVES VALUES(71,'Traifor','Benoît','10/12/1978',77,3);
INSERT INTO ELEVES VALUES(72,'Génial','Clément','10/04/1978',72,1);
INSERT INTO ELEVES VALUES(73,'Paris','Adam','28/06/1974',72,2);
INSERT INTO ELEVES VALUES(74,'Paris','Clémence','20/09/1977',72,NULL);
INSERT INTO ELEVES VALUES(69,'Saitout','Inès','22/11/1969',69,2);

/* INSERTION COURS */
INSERT INTO COURS VALUES(1,'Bases de données',20,3);
INSERT INTO COURS VALUES(2,'Structures de données',20,2);
INSERT INTO COURS VALUES(3,'Programmation Web',10,3);
INSERT INTO COURS VALUES(4,'Physique Chimie',20,1);
INSERT INTO COURS VALUES(5,'On Fait Rien',10000,0);

/* INSERTION PROFESSEURS */
INSERT INTO PROFESSEURS VALUES(1,'CABANES','INFORMATIQUES',NULL,NULL,50000,50000);
INSERT INTO PROFESSEURS VALUES(2,'NOM','RIEN',NULL,NULL,0,0);

/* INSERTION ACTIVITES */
INSERT INTO ACTIVITES VALUES(1,'Football','Sans Nom');
INSERT INTO ACTIVITES VALUES(2,'Tennis',NULL);
INSERT INTO ACTIVITES VALUES(3,'Football','Équipe de foot');

/* INSERTION RESULTATS */
INSERT INTO RESULTATS VALUES(71,1,18);
INSERT INTO RESULTATS VALUES(71,3,17);
INSERT INTO RESULTATS VALUES(74,5,20);
INSERT INTO RESULTATS VALUES(74,2,8);
INSERT INTO RESULTATS VALUES(72,2,10);

/* INSERTION CHARGE */
INSERT INTO CHARGE VALUES(1,1);
INSERT INTO CHARGE VALUES(1,5);
INSERT INTO CHARGE VALUES(2,5);

/* INSERTION ACTIVITES PRATIQUEES */
INSERT INTO ACTIVITES_PRATIQUEES VALUES(71,1,'Football');
INSERT INTO ACTIVITES_PRATIQUEES VALUES(72,3,'Football');
INSERT INTO ACTIVITES_PRATIQUEES VALUES(74,2,'Tennis');
